package software.amazon.smithy.intellij.psi.impl;

import software.amazon.smithy.intellij.psi.SmithyBoolean;
import software.amazon.smithy.intellij.psi.SmithyNumber;

import java.math.BigDecimal;
import java.math.BigInteger;

/**
 * A utility class providing mixins for AST nodes (generated by <a href="https://github.com/JetBrains/Grammar-Kit">Grammar-Kit</a>).
 * <p>
 * All {@link SmithyNumber} value-conversion methods perform safe parsing (by using {@link BigDecimal}) but will fail
 * with an {@link ArithmeticException} if converting to an integral integer type and the number is too large to fit.
 *
 * @author Ian Caffey
 * @since 1.0
 */
public class SmithyPsiImplUtil {
    public static boolean booleanValue(SmithyBoolean b) {
        return Boolean.parseBoolean(b.getText());
    }

    public static double byteValue(SmithyNumber number) {
        return bigDecimalValue(number).byteValueExact();
    }

    public static double shortValue(SmithyNumber number) {
        return bigDecimalValue(number).shortValueExact();
    }

    public static double intValue(SmithyNumber number) {
        return bigDecimalValue(number).intValueExact();
    }

    public static float floatValue(SmithyNumber number) {
        return bigDecimalValue(number).floatValue();
    }

    public static double doubleValue(SmithyNumber number) {
        return bigDecimalValue(number).doubleValue();
    }

    public static long longValue(SmithyNumber number) {
        return bigDecimalValue(number).longValueExact();
    }

    public static BigDecimal bigDecimalValue(SmithyNumber number) {
        return new BigDecimal(number.getText());
    }

    public static BigInteger bigIntegerValue(SmithyNumber number) {
        return bigDecimalValue(number).toBigIntegerExact();
    }
}
